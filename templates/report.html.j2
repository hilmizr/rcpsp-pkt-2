<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>RCPSP Report</title>
  <style>
    body{font-family:Arial,Helvetica,sans-serif;margin:2rem;}
    table{border-collapse:collapse;width:100%;}
    th,td{border:1px solid #aaa;padding:4px;text-align:left;}
    h2{border-bottom:2px solid #444;margin-top:2rem;}
  </style>
</head>
<body>
<h1>RCPSP Project Report</h1>

<h2>Input Data</h2>
<h3>Tasks</h3>{{ tasks_df | safe }}
<h3>Resources</h3>{{ resources_df | safe }}
<h3>Dependencies</h3>{{ deps_df | safe }}
<h3>Project Statistics</h3>{{ stats_df | safe }}     

<h2>Solution Summary</h2>{{ solution_df | safe }}

<h2>Detailed Schedule</h2>{{ schedule_df | safe }}    

<h2>Resource Utilization</h2>{{ util_df | safe }}

<h2>Critical Path</h2>
<ul>{% for c in crit_list %}<li>{{ c }}</li>{% endfor %}</ul>

<h2>Initial Gantt Chart (Before Scheduling)</h2>
<!-- interactive (on screen) -->
<div class="no-print">
  {{ gantt_html_before | safe }}
</div>
<!-- fallback static for PDF/print -->
<div class="print-only">
  <img src="data:image/png;base64,{{ gantt_png_before }}" style="width:100%; height:auto;">
</div>

<h2>Final Gantt Chart (After Scheduling)</h2>
<div class="no-print">
  {{ gantt_html_after | safe }}
</div>
<div class="print-only">
  <img src="data:image/png;base64,{{ gantt_png_after }}" style="width:100%; height:auto;">
</div>

</body>
</html>

<style>
  @media screen {
    .print-only { display: none; }
  }
  @media print {
    .no-print   { display: none; }
    .print-only { display: block; }
  }
</style>
